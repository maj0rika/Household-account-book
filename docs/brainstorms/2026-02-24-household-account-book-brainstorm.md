---
date: 2026-02-24
topic: household-account-book-fullstack-design
---

# AI 자동 분류 가계부 앱 설계

## 무엇을 만드는가

**자연어로 입력하면 AI가 자동 분류하는 개인 가계부 앱.**
웹 + iOS + Android 모두 배포 (Next.js + Capacitor).

사용자는 평소 말투로 자유롭게 적는다:

- "오늘 점심 김밥천국 8000원"
- "스타벅스 아메리카노 4500"
- "점심 김치찌개 9000, 커피 4500, 저녁 치킨 18000"

AI가 자동으로 파싱한다:

- **날짜**: "오늘" → 2026-02-24
- **카테고리**: "김밥천국" → 식비
- **금액**: 8000원
- **설명**: 김밥천국
- **수입/지출 구분**: 자동 판단

사용자는 AI 분류 결과를 확인하고 저장한다. (수정 가능)

커플/가족 구성원이 각자 사용하는 **개인 가계부**이며, 데이터는 공유하지 않는다.
**학습 목적**으로 만들되, 실사용 가능한 수준을 목표로 한다.

## 프리미엄 UX/UI 플로우 및 디자인 시스템

### 1. 핵심 디자인 원칙 (Design Principles)

- **Zero-Depth Entry**: 사용자가 앱을 켜자마자 즉시 입력할 수 있도록 하단 고정 입력바(또는 FAB) 제공.
- **Fluid & Dynamic**: LLM 처리 대기 시간을 지루하지 않게 만드는 스켈레톤 애니메이션 및 자연스러운 트랜지션.
- **One-handed Operation**: AI 파싱 결과 확인 및 수정은 하프 바텀 시트(Bottom Sheet)에서 한 손 조작 가능하게 설계.
- **Aesthetics First**: Glassmorphism 처리된 내비게이션, Subtle Gradient 포인트 컬러, 다크모드 기본 지원 등 세련된 사용자 경험.

### 2. 혁신적인 오토매틱 플로우 (UX Flow)

```text
[입력 트리거]
앱 실행 시 하단 중앙 텍스트 필드 활성화 (음성 입력 버튼 동반 지원 고려)
    │
    ▼
┌────────────────────────────────────────────────────────┐
│ 💬 "오늘 점심 김치찌개 9000원, 스벅 아아 4500원 긁었어" │
└────────────────────────────────────────────────────────┘
    │
    ▼ (전송 시, 텍스트 필드가 위로 스무스하게 올라가며 스켈레톤 로딩 표시)
┌────────────────────────────────────────────────────────┐
│ ✨ AI가 내역을 분석하고 있어요... (블러/글래스 에니메이션)│
└────────────────────────────────────────────────────────┘
    │
    ▼ (분석 완료 시 Bottom Sheet 슬라이드 업)
┌────────────────────────────────────────────────────────┐
│ 📝 방금 쓴 지출을 분류했어요                            │
│                                                        │
│ [ 스와이프 액션으로 개별 삭제 기능 제공 ]               │
│ 🍚 식비    | 점심 김치찌개 | 9,000원  [수정] [✅]        │
│ ☕ 카페    | 스벅 아아    | 4,500원  [수정] [✅]        │
│                                                        │
│ 🧮 총 지출: 13,500원                   (취소) [저장]    │
└────────────────────────────────────────────────────────┘
    │
    ▼ (저장 클릭 시 Bottom Sheet가 부드럽게 닫히며 햅틱 피드백)
┌────────────────────────────────────────────────────────┐
│ 🌈 대시보드 그래프가 실시간으로 통통 튀며(Spring) 업데이트 │
│ [알림 토스트] "2건의 지출이 깔끔하게 기록되었어요!"        │
└────────────────────────────────────────────────────────┘
```

## LLM 통합 전략

### API 프로바이더 교체 가능 설계

```typescript
// 추상 인터페이스
interface TransactionParser {
    parse(input: string, categories: Category[]): Promise<ParsedTransaction[]>;
}

// 구현체를 환경변수로 전환
// KIMI 2.5 (비용 최적화) 또믄 Fireworks AI 사용

### AI 프롬프트 설계 (핵심)

LLM에게 보내는 시스템 프롬프트:

```

너는 가계부 자동 분류기이다.
사용자가 자연어로 입력한 지출/수입 내역을 파싱하여 JSON으로 반환하라.

규칙:

1. 날짜가 없으면 오늘 날짜로 간주
2. "어제", "그제", "지난주 월요일" 등 상대 날짜 해석
3. 금액 단위가 없으면 원(KRW)으로 간주
4. 한 문장에 여러 건이면 각각 분리
5. 수입/지출은 문맥으로 판단 (월급, 용돈 → 수입 / 나머지 → 지출)

사용 가능한 카테고리: {categories}

반환 형식:
[{
"date": "YYYY-MM-DD",
"type": "expense" | "income",
"category": "카테고리명",
"description": "설명",
"amount": 숫자
}]

```

### 비용 관리

- **토큰 절약**: 시스템 프롬프트 캐싱, 카테고리 목록만 동적 삽입
- **Rate Limiting**: 사용자당 일 50건 제한 (무료 티어)
- **에러 핸들링**: LLM 실패 시 수동 입력 폼 폴백

## 기술 스택

| 레이어          | 기술                    | 선택 이유                                                      |
| --------------- | ----------------------- | -------------------------------------------------------------- |
| **FE + BE**     | Next.js 15 (App Router) | Server Actions로 FE/BE 통합. AI 코드 생성 품질 최고            |
| **언어**        | TypeScript 5.x (strict) | 타입 안전성 + AI가 타입 추론을 잘 함                           |
| **스타일링**    | Tailwind CSS 4          | 유틸리티 클래스 기반. AI가 가장 정확하게 생성                  |
| **UI 컴포넌트** | shadcn/ui               | 복붙 방식 컴포넌트. 커스텀 자유도 높음                         |
| **반응형**      | 모바일 퍼스트           | 가계부 특성상 모바일 사용이 주. Tailwind 브레이크포인트로 처리 |
| **DB**          | PostgreSQL (Supabase)   | 무료 티어 충분                                                 |
| **ORM**         | Drizzle ORM             | 타입세이프, SQL에 가까운 직관적 문법                           |
| **인증**        | Better Auth             | Auth.js v5가 아직 베타라서 대안 선택. 안정적                   |
| **LLM**         | Moonshot/Fireworks SDK (OpenAI 호환) | KIMI 2.5 / Fireworks AI |
| **상태관리**    | Zustand                 | 심플, 보일러플레이트 최소                                      |
| **네이티브**    | Capacitor 6             | 웹 코드 그대로 iOS/Android 앱스토어 배포                       |
| **배포 (웹)**   | Vercel (Hobby)          | Next.js 최적화 배포. 무료                                      |
| **배포 (앱)**   | App Store / Google Play | Capacitor 빌드 → 앱스토어 제출                                 |

## 아키텍처

```

┌──────────────────────────────────────────────────────┐
│ Vercel (배포) │
├──────────────────────────────────────────────────────┤
│ │
│ Next.js 15 App Router │
│ │
│ ┌───────────────┐ ┌───────────────────────────┐ │
│ │ React Client │───▶│ Server Actions │ │
│ │ (shadcn/ui) │ │ │ │
│ │ + Tailwind │ │ ┌─────────────────────┐ │ │
│ │ + Zustand │ │ │ LLM Parser Service │ │ │
│ │ │ │ │ (OpenAI / KIMI) │ │ │
│ │ 자연어 입력 폼 │ │ └────────┬────────────┘ │ │
│ │ AI 결과 확인 │ │ │ │ │
│ │ 대시보드/통계 │ │ ┌────────▼────────────┐ │ │
│ └───────────────┘ │ │ Drizzle ORM │ │ │
│ │ └────────┬────────────┘ │ │
│ Better Auth │ │ │ │
│ (인증/세션) │ │ │ │
│ └───────────┼───────────────┘ │
│ ▼ │
│ ┌──────────────────┐ │
│ │ Supabase │ │
│ │ PostgreSQL │ │
│ └──────────────────┘ │
│ │
│ KIMI API / Fireworks API ◀────────┤
│ (외부 LLM 서비스) │
└──────────────────────────────────────────────────────┘

                    ┌──────────────────────────┐
                    │     Capacitor 6          │
                    │                          │
                    │  Next.js 빌드 결과물을     │
                    │  네이티브 앱으로 래핑       │
                    │                          │
                    │  ┌──────┐  ┌──────────┐  │
                    │  │ iOS  │  │ Android  │  │
                    │  └──┬───┘  └────┬─────┘  │
                    └─────┼───────────┼────────┘
                          ▼           ▼
                    App Store    Google Play

```

### Capacitor 동작 방식

```

Next.js (SSG/export) → out/ → Capacitor가 WebView로 래핑 → 네이티브 앱
│
├── API 호출은 Vercel 서버로 (동일)
├── 푸시 알림 (v1.1)
└── 오프라인 캐시 (v1.1)

```

**중요**: Capacitor는 정적 빌드(`next export`)가 필요하므로,
Server Components/Server Actions는 API Route로 래핑하여 클라이언트에서 fetch로 호출하는 구조가 됨.

## DB 스키마

### users

| 컬럼       | 타입      | 설명          |
| ---------- | --------- | ------------- |
| id         | uuid (PK) | 사용자 ID     |
| email      | text      | 이메일        |
| name       | text      | 이름          |
| avatar_url | text      | 프로필 이미지 |
| created_at | timestamp | 생성일        |

### categories

| 컬럼       | 타입              | 설명                         |
| ---------- | ----------------- | ---------------------------- |
| id         | uuid (PK)         | 카테고리 ID                  |
| user_id    | uuid (FK → users) | 소유 사용자                  |
| name       | text              | 카테고리명 (식비, 교통비 등) |
| icon       | text              | 아이콘 이모지                |
| type       | text              | income / expense             |
| sort_order | integer           | 정렬 순서                    |
| is_default | boolean           | 기본 카테고리 여부           |

### transactions

| 컬럼           | 타입              | 설명                    |
| -------------- | ----------------- | ----------------------- |
| id             | uuid (PK)         | 거래 ID                 |
| user_id        | uuid (FK → users) | 소유 사용자             |
| category_id    | uuid (FK)         | 카테고리                |
| type           | text              | income / expense        |
| amount         | integer           | 금액 (원 단위)          |
| description    | text              | 설명 (AI가 추출한 내용) |
| original_input | text              | 사용자 원본 입력 텍스트 |
| date           | date              | 거래 날짜               |
| memo           | text              | 메모                    |
| created_at     | timestamp         | 생성일                  |
| updated_at     | timestamp         | 수정일                  |

### budgets

| 컬럼        | 타입              | 설명              |
| ----------- | ----------------- | ----------------- |
| id          | uuid (PK)         | 예산 ID           |
| user_id     | uuid (FK → users) | 소유 사용자       |
| category_id | uuid (FK)         | 카테고리          |
| amount      | integer           | 예산 금액         |
| month       | text              | 대상 월 (YYYY-MM) |
| created_at  | timestamp         | 생성일            |

## 디렉토리 구조

```

household-account-book/
├── src/
│ ├── app/ # Next.js App Router
│ │ ├── (auth)/ # 인증 관련 페이지
│ │ │ ├── login/
│ │ │ └── register/
│ │ ├── (dashboard)/ # 인증 필요한 페이지
│ │ │ ├── layout.tsx # 사이드바 + 헤더
│ │ │ ├── page.tsx # 대시보드 (메인)
│ │ │ ├── transactions/ # 거래 내역
│ │ │ ├── categories/ # 카테고리 관리
│ │ │ ├── budget/ # 예산 관리
│ │ │ ├── statistics/ # 통계
│ │ │ └── settings/ # 설정 (프로필, LLM 키 등)
│ │ ├── api/ # API Routes
│ │ │ └── auth/[...all]/ # Better Auth
│ │ ├── layout.tsx # 루트 레이아웃
│ │ └── page.tsx # 랜딩 페이지
│ ├── components/
│ │ ├── ui/ # shadcn/ui 컴포넌트
│ │ ├── layout/ # Header, Sidebar, Footer
│ │ ├── transaction/ # 거래 관련 컴포넌트
│ │ │ ├── NaturalInput.tsx # 자연어 입력 폼
│ │ │ ├── ParsedPreview.tsx # AI 파싱 결과 확인
│ │ │ └── TransactionList.tsx # 거래 목록
│ │ ├── dashboard/ # 대시보드 위젯
│ │ └── chart/ # 차트 컴포넌트
│ ├── server/
│ │ ├── db/
│ │ │ ├── index.ts # Drizzle 클라이언트
│ │ │ ├── schema.ts # DB 스키마 정의
│ │ │ └── migrations/ # 마이그레이션 파일
│ │ ├── actions/ # Server Actions
│ │ │ ├── transaction.ts # 거래 CRUD
│ │ │ ├── parse.ts # AI 파싱 액션 (핵심)
│ │ │ ├── category.ts
│ │ │ └── budget.ts
│ │ ├── llm/ # LLM 통합 레이어
│ │ │ ├── parser.ts # TransactionParser 인터페이스
│ │ │ ├── kimi.ts # KIMI 및 Fireworks 구현체
│ │ │ ├── prompt.ts # 프롬프트 템플릿
│ │ │ └── index.ts # 팩토리 (환경변수로 전환)
│ │ └── auth.ts # Better Auth 설정
│ ├── lib/
│ │ ├── utils.ts # 유틸리티 함수
│ │ └── constants.ts # 기본 카테고리, 상수
│ ├── stores/ # Zustand 스토어
│ │ └── useTransactionStore.ts
│ └── types/ # 타입 정의
│ └── index.ts
├── drizzle.config.ts
├── capacitor.config.ts # Capacitor 설정
├── ios/ # iOS 네이티브 프로젝트 (자동 생성)
├── android/ # Android 네이티브 프로젝트 (자동 생성)
├── next.config.ts
├── tailwind.config.ts
├── tsconfig.json
├── package.json
└── .env.local # KIMI_API_KEY, FIREWORKS_API_KEY 등

````

## 프리미엄 UI 디자인 및 레이아웃 전략

### 1. 트렌디한 디자인 시스템 (Modern Aesthetics)

가계부 앱은 딱딱하지 않고 **세련되며 감성적인(Wow Factor)** 경험을 주어야 합니다.

- **다크모드 최적화 (Sleek Dark Mode)**: 딥 다크 배경(#121212)에 비비드한 HSL 네온 컬러를 포인트로 사용하여 데이터 강조.
- **글래스모피즘 (Glassmorphism)**: 탭바와 플로팅 컴포넌트에는 반투명 블러 효과(`backdrop-blur`)를 주어 깊이감 제공.
- **타이포그래피**: `Pretendard`(한글)와 `SF Pro Display`(숫자, 영문) 혼용을 통해 금융 데이터의 가독성과 프리미엄한 느낌 동시 확보.
- **마이크로 애니메이션**: 리스트 추가 시 Framer Motion 디졸브/스케일 애니메이션, 버튼 탭 시 부드러운 스케일 피드백(`active:scale-95`).

### 2. 모바일 퍼스트 및 반응형 뷰 (Responsive Layout)

가계부는 이동 중에 즉시 입력하는 경우가 90% 이상이므로 모바일 UX를 완벽하게 깎는 것을 최우선으로 합니다.

| 화면/컴포넌트     | 모바일 (< 640px)                                | 데스크톱 (lg: > 1024px)            | 인터랙션 및 애니메이션 포인트                    |
| ----------------- | ----------------------------------------------- | ---------------------------------- | ------------------------------------------------ |
| **네비게이션**    | 반투명 플로팅 하단 탭바                         | 고정된 좌측 사이드바 (Glass Panel) | 탭 이동 시 페이지 슬라이드/페이드 인 트랜지션    |
| **자연어 입력**   | 탭바 위 하단 고정 텍스트 필드 (위로 확장)       | 상단 중앙 고정형 검색창 스타일     | 포커스 시 배경 어두워짐, 필드 크기 부드러운 확장 |
| **거래 목록**     | 좌우 여백을 둔 둥근 모서리의 플로팅 카드 리스트 | 넉넉한 여백의 데이터 테이블        | 개별 데이터 삭제 시 스와이프 제스처 지원         |
| **대시보드 요약** | 최상단에 스무스한 그라데이션 금액 카드          | 2~3열 위젯 그리드 스타일           | 스크롤 시 상단 헤더로 압축되는 패럴랙스 효과     |

### 3. 모바일 메인 화면 (다이나믹 와이어프레임)

```text
📱 [프리미엄 모바일 대시보드 뷰]

┌───────────────────────────────────────┐
│  [메뉴]       2026년 2월 ▾      [알림🔔]│
│                                       │
│  ╭─────────────────────────────────╮  │
│  │ (은은한 퍼플/블루 Mesh Gradient 배경) │  │
│  │ 💰 이번 달 남은 여윳돈           │  │
│  │ ₩ 308,000                       │  │
│  │                                 │  │
│  │ ↘ 지출 892,000   ↗ 수입 1,200,000 │  │
│  ╰─────────────────────────────────╯  │
│                                       │
│  [이번 주 지출 통계 미니 바 차트 📊]     │
│                                       │
│  오늘 (2/24)                           │
│  ┌─────────────────────────────────┐  │
│  │ 🍚 식비   #김치찌개        -9,000 │  │
│  │ ☕ 카페   #스타벅스        -4,500 │  │
│  └─────────────────────────────────┘  │
│                                       │
│  어제 (2/23)                           │
│  ┌─────────────────────────────────┐  │
│  │ � 교통   #택시           -12,000 │  │
│  └─────────────────────────────────┘  │
│                                       │
│                                       │
│                  ...                  │
│                                       │
│  ╭─────────────────────────────────╮  │ ← 포커스 시 위로 자연스럽게 늘어남
│  │ 💬 오늘 뭐 썼어? 편하게 적어봐요!  🎙 │  │ (키보드 올라올 때 매끄럽게 따라가기)
│  ╰─────────────────────────────────╯  │
│ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ ─ │ ← 경계선 없이 블러 처리된 하단 탭바
│   🏠 홈     📊 분석     ➕ 입력     ⚙️ 설정 │
└───────────────────────────────────────┘
````

### 지출

| 이모지 | 카테고리    |
| ------ | ----------- |
| 🍚     | 식비        |
| ☕     | 카페/간식   |
| 🚌     | 교통        |
| 🏠     | 주거/관리비 |
| 🛒     | 생활용품    |
| 👕     | 의류/미용   |
| 🏥     | 의료/건강   |
| 📱     | 통신        |
| 🎮     | 여가/취미   |
| 📚     | 교육        |
| 🎁     | 경조사/선물 |
| 💳     | 기타 지출   |

### 수입

| 이모지 | 카테고리    |
| ------ | ----------- |
| 💰     | 급여        |
| 💵     | 용돈/부수입 |
| 📈     | 투자수익    |
| 💳     | 기타 수입   |

## 핵심 기능 (MVP)

### v1.0 - AI 자동 분류 가계부

- **자연어 입력**: 한 줄 또는 여러 건 한번에 입력
- **AI 자동 파싱**: 날짜, 카테고리, 금액, 설명 자동 추출
- **확인 후 저장**: AI 결과를 사용자가 확인/수정 후 저장
- **수동 입력 폴백**: AI 실패 시 전통적 폼 입력 지원
- **카테고리 관리**: 기본 카테고리 제공 + 커스텀 추가
- **월별 대시보드**: 수입/지출 요약, 카테고리별 차트
- **인증**: 이메일/비밀번호 + Google 소셜 로그인

### v1.1 - 개선

- 예산 설정 & 알림
- 거래 검색/필터
- 월별/연별 통계 차트
- 반복 거래 (월세, 구독료 등)
- AI 학습 개선 (사용자 수정 피드백 반영)

## 배포 파이프라인

### 웹 배포

```
GitHub Push → Vercel Auto Deploy
├── Preview (PR마다 자동)
└── Production (main 브랜치)
```

### 앱 배포

```
npm run build:static → npx cap sync → Xcode / Android Studio → 앱스토어 제출

1. next build (정적 export)
2. npx cap copy        (빌드 결과물을 ios/android에 복사)
3. npx cap open ios    (Xcode에서 빌드/배포)
4. npx cap open android (Android Studio에서 빌드/배포)
```

### 환경변수

```
# Vercel Dashboard (웹)
DATABASE_URL          (Supabase PostgreSQL)
BETTER_AUTH_SECRET    (인증 시크릿)
GOOGLE_CLIENT_ID      (소셜 로그인)
GOOGLE_CLIENT_SECRET
LLM_PROVIDER          ("kimi" | "fireworks")
KIMI_API_KEY
FIREWORKS_API_KEY

# 앱에서는 서버 URL만 필요 (API는 Vercel 서버에서 처리)
NEXT_PUBLIC_API_URL   (배포된 Vercel URL)
```

## 미결 사항

- KIMI 2.5 API의 OpenAI SDK 호환 여부 → 호환되면 SDK 교체 없이 baseURL만 변경
- 차트 라이브러리 선택 (Recharts vs Chart.js) → 구현 시 결정
- LLM 응답 지연 시 UX (로딩 스피너 vs 스트리밍) → 구현 시 결정
- Capacitor + Next.js 정적 export 시 라우팅 호환성 검증 필요
- Apple 개발자 계정 ($99/년), Google Play 개발자 계정 ($25 일회성) 필요

## 다음 단계

→ 구현 시작: 프로젝트 초기화 + DB 스키마 + 인증 + LLM 파서 셋업
