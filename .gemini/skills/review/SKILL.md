---
description: "코드 리뷰 후 통과 시 커밋/푸시, 실패 시 수정 후 재리뷰"
user_invocable: true
---

# 코드 리뷰 에이전트

커밋 전 코드 품질 게이트. 리뷰 통과 시에만 커밋/푸시합니다.

## 리뷰 프로세스

```
[변경사항 수집]
    ↓
[1단계: 자동 검증] tsc + build
    ↓ (실패 시 수정 → 재검증)
[2단계: 코드 리뷰] 아래 체크리스트 기준
    ↓ (이슈 발견 시 수정 → 재리뷰)
[3단계: 커밋 & 푸시]
```

## 1단계: 자동 검증

1. `npx tsc --noEmit` — 타입 에러 0개
2. `npm run build` — 빌드 성공

실패 시: 에러 수정 후 재검증. 사용자 판단 필요 시 보고.

## 2단계: 코드 리뷰 체크리스트

### 필수 (블로커)
- [ ] **타입 안전성**: `any` 사용 없음, 타입 추론 정확
- [ ] **보안**: 시크릿 노출 없음, SQL injection 없음, 인증 체크 누락 없음
- [ ] **Server Action**: `"use server"` 파일에서 인증 확인 (getAuthUserId)
- [ ] **데이터 정합성**: DB 쿼리 WHERE 절에 userId 조건 포함
- [ ] **import 정리**: 미사용 import 없음

### 권장 (경고)
- [ ] **일관성**: 기존 코드 패턴과 동일한 스타일 (네이밍, 구조, 에러 처리)
- [ ] **중복 코드**: 같은 로직이 2곳 이상 반복되면 추출 고려
- [ ] **하드코딩**: 매직 넘버, 매직 스트링 없음 (상수 추출)
- [ ] **접근성**: 버튼에 type 속성, 인터랙티브 요소에 적절한 시맨틱
- [ ] **반응형**: 모바일/데스크톱 양쪽에서 의도대로 표시

### 참고 (정보)
- [ ] **번들 크기**: 새 의존성 추가 시 크기 확인
- [ ] **성능**: 불필요한 리렌더링, N+1 쿼리 없음
- [ ] **에러 UX**: 사용자에게 기술적 에러 직접 노출하지 않음

## 리뷰 결과 형식

```markdown
## 🔍 코드 리뷰 결과

### 자동 검증
- tsc: ✅/❌
- build: ✅/❌

### 리뷰 요약
- 변경 파일: N개
- 추가: +N줄 / 삭제: -N줄

### 이슈

#### 🔴 블로커 (커밋 차단)
- [ ] `파일:라인` — 설명

#### 🟡 경고 (수정 권장)
- [ ] `파일:라인` — 설명

#### 🟢 참고 (선택)
- [ ] `파일:라인` — 설명

### 판정: ✅ PASS / ❌ FAIL
```

## 3단계: 커밋 & 푸시

리뷰 PASS 시:
1. 변경 파일 staging (`git add` — 구체적 파일명)
2. 커밋 메시지 작성 (한국어, 변경 내용 요약)
3. `git push origin main`

리뷰 FAIL 시:
1. 블로커 이슈 자동 수정
2. 수정 후 1단계부터 재실행
3. 최대 3회 반복 후에도 실패 시 사용자에게 보고

## 규칙

- 블로커가 1개라도 있으면 절대 커밋하지 않음
- 경고는 수정 후 커밋 (간단한 것만)
- 참고는 무시하고 커밋 가능
- `.env`, `credentials`, 시크릿 파일은 절대 커밋하지 않음
